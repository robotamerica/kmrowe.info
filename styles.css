:root{
  --bg:#0a0e14; --fg:#cdd6f4; --muted:#151a21; --gutter:#11161c;
  --border:rgba(255,255,255,.10); --accent:#7aa2f7;
  --green:#a6da95; --yellow:#eed49f; --red:#ee99a0; --mag:#c6a0f6; --cyan:#91d7e3;
  --shadow:0 18px 60px rgba(0,0,0,.45);
  --head-h:44px; --foot-h:28px;
}

body.light{
  --bg:#ffffff; --fg:#0b1220; --muted:#f1f4f9; --gutter:#e9eef6;
  --border:#d5dbe7; --accent:#2b63ff; --shadow:0 10px 40px rgba(0,0,0,.10);
}

*{ box-sizing:border-box }
html,body{ height:100% }

html,body,button,input,textarea,select,pre,code,kbd,samp{
  font-family:"JetBrains Mono",ui-monospace,SFMono-Regular,Menlo,Consolas,"Liberation Mono",monospace;
  -webkit-font-smoothing:antialiased; -moz-osx-font-smoothing:grayscale;
}

body{ margin:0; background:var(--bg); color:var(--fg) }
strong,b{ color:var(--green); font-weight:700 }
body.light strong,body.light b{ color:#16794e }

a{
  color:var(--accent); text-decoration:none;
  border-bottom:1px dotted transparent;
  transition:color .15s ease,border-color .15s ease;
}
a:hover{ color:var(--green); border-bottom-color:currentColor }
body.light a:hover{ color:#16794e }
a:focus-visible{ outline:none; box-shadow:0 0 0 2px var(--accent); border-radius:.15rem }

/* Mobile desktop-optimised notice */
.modal-overlay{
  position:fixed; inset:0; display:none; place-items:center; z-index:120;
  background:rgba(0,0,0,.6); backdrop-filter:blur(6px);
}
.modal-card{
  width:min(520px,92vw);
  background:var(--bg); border:1px solid var(--border); border-radius:14px;
  box-shadow:var(--shadow); padding:1rem 1.1rem;
}
.modal-title{ margin:0 0 .4rem 0; font-weight:700; color:var(--green) }
.modal-text{ margin:.25rem 0 .75rem 0; opacity:.9 }
.modal-optout{ display:flex; align-items:center; gap:.5rem; font-size:.95rem; opacity:.9; margin-bottom:.85rem }
.modal-actions{ display:flex; gap:.6rem; justify-content:flex-end }

.btn-ghost{
  background:transparent; color:var(--fg);
  border:1px solid var(--border); border-radius:.45rem; padding:.45rem .8rem;
}
.btn-ghost:focus-visible{ outline:none; box-shadow:0 0 0 2px var(--accent) }

.btn-accent{
  background:rgba(122,162,247,.16); color:var(--fg);
  border:1px solid var(--accent); border-radius:.45rem; padding:.45rem .8rem;
}
.btn-accent:hover{ background:rgba(122,162,247,.24) }
.btn-accent:focus-visible{ outline:none; box-shadow:0 0 0 2px var(--accent) }

@media (min-width: 781px){
  /* Never show on desktop widths */
  #mobileNotice{ display:none !important; }
}

/* Cursor & trails */
body{
  cursor:url("data:image/svg+xml;utf8,\
  <svg xmlns='http://www.w3.org/2000/svg' width='16' height='24' viewBox='0 0 16 24'>\
    <rect x='7' y='2' width='2' height='20' fill='%23ffffff'/>\
    <rect x='6' y='2' width='4' height='2' fill='%237aa2f7'/>\
    <rect x='6' y='20' width='4' height='2' fill='%237aa2f7'/>\
  </svg>") 8 12, text;
  -webkit-tap-highlight-color: transparent;
}
button,a{ cursor:pointer; touch-action:manipulation }

#trails{ position:fixed; inset:0; pointer-events:none; z-index:70 }
.caret-trail{
  position:fixed; width:2px; height:12px; background:var(--accent);
  transform:translate(-50%,-50%); border-radius:2px; mix-blend-mode:screen;
  box-shadow:0 0 12px var(--accent);
}

/* Header / Footer */
.bufferline{
  position:sticky; top:0; left:0; right:0; z-index:60;
  display:flex; justify-content:space-between; align-items:center;
  background:var(--gutter); border-bottom:1px solid var(--border);
  padding: calc(env(safe-area-inset-top) + .3rem) .6rem .3rem;
  font-weight:700;
}
.bufferline #bufferTitle{
  background:var(--bg); border:1px solid var(--border);
  border-radius:.35rem; padding:.2rem .55rem;
}
.bufferline .hint{ opacity:.75 }

.statusline{
  position:fixed; bottom:0; left:0; right:0; z-index:5;
  display:flex; justify-content:space-between; align-items:center;
  background:var(--gutter); border-top:1px solid var(--border);
  padding: .25rem .6rem calc(env(safe-area-inset-bottom) + .25rem);
  pointer-events:none; /* let scroll pass through */
}
.statusline .pill{ background:var(--accent); color:black; border-radius:.25rem; padding:.05rem .45rem; margin-right:.5rem }
.statusline .left, .statusline .right, .statusline .pill{ pointer-events:auto } /* keep clickable */

/* Layout */
.nvim-layout.centered{
  max-width:1280px; margin:4vh auto 7vh auto;
  display:grid; grid-template-columns:420px 1fr; gap:3rem; align-items:start;
  padding:0 1.25rem;
}
.left-rail{
  position:sticky; top:3.5rem; align-self:start;
  display:flex; flex-direction:column; align-items:center; gap:1.2rem;
  padding-top:2.5rem; text-align:center;
}
.right-pane{ min-width:0 }

/* Identity */
.headshot-left{
  width:220px; aspect-ratio:1/1; border-radius:50%;
  object-fit:cover; border:2px solid var(--border); box-shadow:var(--shadow);
  transition:transform .25s ease, box-shadow .3s ease; display:block;
}
.headshot-left:hover{
  transform:scale(1.03);
  box-shadow:0 0 0 2px rgba(255,255,255,0.15),0 12px 22px rgba(0,0,0,0.5),0 0 55px rgba(122,162,247,0.25);
}
.ansi-logo{
  white-space:pre; line-height:1.05; opacity:.95;
  font-size:clamp(4px,0.35vw + 2px,7.5px);
  margin-top:.5rem; max-width:90%; text-align:center;
  filter:drop-shadow(0 8px 22px rgba(0,0,0,.35));
}
.ansi-logo .rainbow{
  background:linear-gradient(90deg,#8aadf4,#a6da95,#eed49f,#f5a97f,#c6a0f6,#91d7e3,#8aadf4);
  background-size:250% 100%;
  -webkit-background-clip:text; background-clip:text; color:transparent;
  animation:logo-sweep 18s linear infinite; text-shadow:0 0 6px rgba(122,162,247,.15);
}
.ansi-logo .subline{
  display:block; font-size:.68rem; letter-spacing:.25px;
  margin-top:.15rem; opacity:.85; text-align:center;
}

/* Menu + Content */
.titlebar{ display:flex; justify-content:space-between; align-items:center; margin-bottom:.6rem }
.mode{ color:var(--green); font-weight:800 }

.menu-window{
  background:var(--bg); border:1px solid var(--border); border-radius:14px;
  box-shadow:var(--shadow); padding:.6rem .6rem; margin-bottom:1rem;
}
.menu-grid{ list-style:none; margin:0; padding:.4rem .6rem; border-bottom:1px solid var(--border) }
.menu-grid .row{
  display:grid; grid-template-columns:auto 1fr auto; gap:.2rem .8rem;
  align-items:center; padding:.28rem .35rem; border-radius:.45rem;
}
.menu-grid .row.active .btn{ background:rgba(122,162,247,.14); font-weight:700; color:var(--green) }
.k{ opacity:.75 }
.btn{ background:transparent; border:0; color:inherit; text-align:left; padding:.25rem .45rem; border-radius:.45rem }
.btn:focus-visible{ outline:none; box-shadow:0 0 0 2px var(--accent) }

/* Content card with internal scroll (mobile-safe) */
.content-card{
  background:var(--bg); border:1px solid var(--border); border-radius:14px;
  box-shadow:var(--shadow); padding:0; overflow:hidden; display:block;
  height:calc(100svh - var(--head-h) - var(--foot-h) - 16px);
  scrollbar-gutter: stable both-edges;
}
@supports (height: 100lvh){
  .content-card{ height:calc(100lvh - var(--head-h) - var(--foot-h) - 16px) }
}
@supports (height: 100dvh){
  .content-card{ height:calc(100dvh - var(--head-h) - var(--foot-h) - 16px) }
}
.tab-content{
  display:none; height:100%; overflow:auto; overscroll-behavior:contain;
  -webkit-overflow-scrolling:touch;
  padding:1rem 1.2rem calc(1rem + var(--foot-h) + env(safe-area-inset-bottom)); /* clear footer */
  scrollbar-color: rgba(122,162,247,.35) var(--gutter); /* Firefox */
}
.tab-content.active{ display:block }
.content-card h1{ margin:.1rem 0 .35rem 0 }
.content-card p{ opacity:.92; max-width:70ch }

/* Scrollbar styling (WebKit) */
.tab-content::-webkit-scrollbar{ width:10px }
.tab-content::-webkit-scrollbar-track{ background:var(--gutter); border-left:1px solid var(--border) }
.tab-content::-webkit-scrollbar-thumb{ background:rgba(122,162,247,.35); border:2px solid var(--gutter); border-radius:10px }
.tab-content:hover::-webkit-scrollbar-thumb{ background:rgba(122,162,247,.55) }
body.light .tab-content::-webkit-scrollbar-track{ background:#f6f8fd }
body.light .tab-content::-webkit-scrollbar-thumb{ background:rgba(43,99,255,.35); border-color:#f6f8fd }
body.light .tab-content:hover::-webkit-scrollbar-thumb{ background:rgba(43,99,255,.55) }

/* Contact */
.contact{ margin-top:1rem; display:flex; gap:.6rem; align-items:center }
.shield{ border:1px dashed var(--border); background:transparent; color:inherit; border-radius:.5rem; padding:.25rem .6rem }
.mail.hidden{ display:none }
.copied{ font-size:.85rem; opacity:.75 }
.copied.hidden{ display:none }

/* Command palette */
.cmd-overlay{ position:fixed; inset:0; display:none; place-items:center; background:rgba(0,0,0,.55); backdrop-filter:blur(6px); z-index:80 }
.cmd-card{ width:min(720px,92vw); background:var(--bg); border:1px solid var(--border); border-radius:14px; box-shadow:var(--shadow); padding:.9rem; gap:.5rem }
.cmd-title{ font-weight:700; margin-bottom:.5rem }
.cmd-input{ width:100%; border:1px solid var(--border); background:transparent; color:inherit; border-radius:.45rem; padding:.5rem .7rem; font-family:inherit }
.cmd-input::-webkit-search-cancel-button{ display:none }
.cmd-list{ list-style:none; margin:.6rem 0 0 0; padding:0; max-height:50vh; overflow:auto }
.cmd-item{ padding:.45rem .6rem; border-radius:.45rem }
.cmd-item.selected{ background:rgba(122,162,247,.16) }
.cmd-empty{ opacity:.7; padding:.6rem }

.cmd-label{ font-weight:600 }
.cmd-snippet{ display:block; font-size:.78rem; color:var(--fg); opacity:.7; margin:.15rem 0 0 1rem }

mark.hit, mark.hit-inline{ background:rgba(122,162,247,.25); color:inherit; padding:0 .15em; border-radius:.25rem }
body.light mark.hit, body.light mark.hit-inline{ background:rgba(43,99,255,.18) }

/* Responsive */
@media (max-width:1040px){
  .nvim-layout.centered{ grid-template-columns:1fr; gap:1.2rem; margin:2vh auto 8vh auto }
  .left-rail{ position:static }
  .headshot-left{ margin:0 auto }
  .ansi-logo{ display:none }
}
@media (max-width:640px){
  .headshot-left{ width:160px }
}
@media (prefers-reduced-motion:reduce){
  #trails{ display:none }
  .ansi-logo .rainbow{ animation:none }
}

/* Animations */
@keyframes logo-sweep{ 0%{background-position:0% 50%} 100%{background-position:250% 50%} }